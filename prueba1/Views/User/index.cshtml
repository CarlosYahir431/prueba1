@model IEnumerable<VelazquezYahir.Models.Domain.Usuario>


@{
	Layout = "_LayoutDashboard";
}
<h1>
	Dashoard
</h1>


<div class="container-fluid">
	<div class="offset-12">
		<div class="card border">
			<div class="card-header">
				<h2 class="">Lista de usuario</h2>
				<div class="">
					<a asp-action="Crear" class="btn btn-success mx-auto btn-md"> Nuevo</a>
				</div>
			</div>
			<div class="card-body"> 
				<div class="table-responsive">
					@if (Model.Count() > 0)
					{
						<table class="table table-primary table-hover" id="tblUsuarios" width="100%" cellspacing="0">
							<thead>
								<tr>
									<th> @Html.DisplayNameFor(x => x.Nombre) </th>
									<th> @Html.DisplayNameFor(x => x.UserName) </th>
									<th> Rol </th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody>
								@{

								}
								@foreach (var Item in Model)
								{
									<tr>
										<td> @Html.DisplayFor(x => Item.Nombre) </td>
										<td> @Html.DisplayFor(x => Item.UserName) </td>
										<td> @Html.DisplayFor(x => Item.Roles.Nombre) </td>
										<td>
											<a class="btn btn-warning" asp-action="Editar" asp-route-id="@Item.PkUsuario">
												<i class="fa-solid fa-pen-to-square"></i> Editar
											</a>
											<a class="btn btn-danger eliminar-usuario" data-id="@Item.PkUsuario"><i class="fa-solid fa-trash"></i> Eliminar</a>
										</td>
									</tr>
								}
							</tbody>
						</table>
					}
					else
					{
						<p>No hay registros</p>
					}
				</div>
			</div>
		</div>
	</div>
</div>
@section Scripts {
	<script>
		$(document).ready(function () {




			$('.eliminar-usuario').on('click', function () {
				//if (confirm('¿Estás seguro de que deseas eliminar este artículo?')) {}


				Swal.fire({
					title: "Esta seguro que deseas borrar?",
					text: "No podrás revertir esto.!",
					icon: "warning",

					showCancelButton: true,
					confirmButtonColor: "#3085d6",
					cancelButtonColor: "#d33",
					confirmButtonText: "Sí, deseo borrar!"
				}).then((result) => {
					if (result.isConfirmed) {

						var usuarioid = $(this).data('id');

						$.ajax({
							url: '/User/Eliminar/' + usuarioid,
							type: 'DELETE',
							success: function (data) {
								console.log(data)

								if (data.success == true) {
									location.reload();
								}

							}
						});


						Swal.fire({
							title: "Eliminando!",
							text: "ha sido eliminado correctamente.",
							icon: "success",
							timer: 700
						});
					}
				});

			});

		});






	</script>
}