@model IEnumerable<VelazquezYahir.Models.Domain.Categoria>

@{
	ViewData["Title"] = "Index";
	Layout = "~/Views/Shared/_LayoutDashboard.cshtml";
}

<h1>Index</h1>

<p>
	<a asp-action="Crear" class="btn btn-success mx-auto btn-md">Create Nueva Categoria</a>
</p>
<table class="table">
	<thead>
		<tr>
			<th>
				@Html.DisplayNameFor(model => model.Nombre)
			</th>
			<th>Acciones</th>
		</tr>
	</thead>
	<tbody>
		@foreach (var item in Model)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelItem => item.Nombre)
				</td>
				<td>
					<a asp-action="Edit" asp-route-id="@item.PkCategoria">Edit</a>
					<a class="btn btn-danger eliminar-categoria" data-id="@item.PkCategoria"><i class="fa-solid fa-trash"> Eliminar</a>
				</td>
			</tr>
		}
	</tbody>
</table>

@section Scripts {
	<script>
		$(document).ready(function () {




			$('.eliminar-categoria').on('click', function () {
				//if (confirm('¿Estás seguro de que deseas eliminar este artículo?')) {}


				Swal.fire({
					title: "Esta seguro que deseas borrar?",
					text: "No podrás revertir esto.!",
					icon: "warning",

					showCancelButton: true,
					confirmButtonColor: "#3085d6",
					cancelButtonColor: "#d33",
					confirmButtonText: "Sí, deseo borrar!"
				}).then((result) => {
					if (result.isConfirmed) {

						var categoriaid = $(this).data('id');

						$.ajax({
							url: '/Categoria/Eliminar/' + categoriaid,
							type: 'DELETE',
							success: function (data) {
								console.log(data)

								if (data.success == true) {
									location.reload();
								}

							}
						});


						Swal.fire({
							title: "Eliminando!",
							text: "ha sido eliminado correctamente.",
							icon: "success",
							timer: 700
						});
					}
				});

			});

		});






	</script>
}
